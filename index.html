<!DOCTYPE html>
<html lang="en">
<head>
<link rel="manifest" href="manifest.json">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AFSAR AGRO</title>
<script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
<meta name="theme-color" content="#66cdaa">
<link rel="icon" href="icon-192.png" sizes="192x192">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<h2>AFSAR AGRO</h2>

<iframe id="printFrame" style="display: none;"></iframe>

<div>
  <label>Customer Name:
    <input type="text" id="customerName" list="customerSuggestions">
    <datalist id="customerSuggestions"></datalist>
  </label>
  <label>Bill No: <input type="number" id="billNo" readonly></label>
  <label>Date: <input type="text" id="billDate" readonly></label>
</div>


<hr>

<div>
  <input type="text" id="itemName" placeholder="Item Name" list="itemSuggestions">
<datalist id="itemSuggestions"></datalist>
  <input type="number" id="itemPrice" placeholder="Price">
  <input type="number" id="itemQty" placeholder="Qty" min="1" max="99" oninput="autoAddItem()">
  <button onclick="addItem()">â• Add</button>
</div>

<table id="itemTable">
  <thead>
    <tr><th>Item</th><th>Price</th><th>Qty</th><th>Amount</th><th>âŒ</th></tr>
  </thead>
  <tbody></tbody>
</table>

<div class="total-box">Total: â‚¹<span id="totalAmount">0</span></div>
<table style="width: 100%; margin-top: 5px;">
  <tr>
    <td><strong>Total Items:</strong> <span id="pTotalItems"></span></td>
    <td><strong>Total Quantity:</strong> <span id="pTotalQty"></span></td>
  </tr>
</table>

<div style="text-align:right; margin-top:5px;">
  <label>Paid Amount: <input type="number" id="paidAmount" oninput="updateStatus()"></label><br>
  <div>Remaining: â‚¹<span id="remaining">0</span></div>
  <div>Status: <strong id="status">Unpaid</strong></div>
</div>

<div style="text-align:center; margin-top:10px;">
  <strong><span id="pMark"></span></strong>
</div>

<button onclick="saveAndPrint()">ğŸ’¾ğŸ–¨ï¸ Save & Print</button>
<button onclick="deleteBill()">ğŸ—‘ï¸ Delete Bill</button>
<button onclick="deleteAllBills()">ğŸ§¹ Delete All Bills</button>
<!-- Clear button with password protection -->
    <button id="clearButton">Clear</button>
<hr>
<h3>ğŸ” Search </h3>
<input type="text" id="searchInput" placeholder="Enter Bill No or Customer Name">
<button onclick="loadBill()">Load Bill</button>

<div id="printArea" style="display:none;">
  <div class="print-bill">
    <h3 style="text-align:center;">ğŸ™ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦ !</h3>
    <table style="width:100%; margin-bottom:5px;">
      <tr>
        <td><strong>Customer:</strong> <span id="pCustomer"></span></td>
        <td><strong>Bill No:</strong> <span id="pBillNo"></span></td>
        <td><strong>Date:</strong> <span id="pDate"></span></td>
      </tr>
    </table>

    <table>
  <thead><tr><th>Item</th><th>Qty</th><th>Amount</th></tr></thead>
  <tbody id="pItems"></tbody>
  <tfoot>
    <tr>
      <td><strong>Total Items:</strong> <span id="pTotalItems"></span></td>
      <td><strong>Total Qty:</strong> <span id="pTotalQty"></span></td>
      <td></td>
    </tr>
  </tfoot>
</table>

    <div style="text-align:right; margin-top:5px;">
      <strong>Total: â‚¹<span id="pTotal"></span></strong><br>
      <strong>Paid: â‚¹<span id="pPaid"></span></strong><br>
      <strong>Remaining: â‚¹<span id="pRemain"></span></strong><br>
      <strong>Status: <span id="pStatus"></span></strong>
    </div>
  </div>
</div>

<script src="js/script.js"></script>

<div style="text-align:right;">
  <label><input type="checkbox" id="billMark"> Mark as Duplicate</label>
</div>

<hr>
<h3>ğŸ“† Filter Bills By Date</h3>
<label>From: <input type="date" id="fromDate"></label>
<label>To: <input type="date" id="toDate"></label>
<button onclick="filterBills()">ğŸ“„ Show Bills</button>
<button onclick="downloadXML()">â¬‡ï¸ Download XML</button>

<label>Filter By: 
  <select id="markFilter">
    <option value="all">ğŸ“‹ All Bills</option>
    <option value="marked">âœ… Marked Only</option>
    <option value="unmarked">âŒ Unmarked Only</option>
  </select>
</label>

<table id="filteredTable" style="margin-top:10px; display:none;">
  <thead>
    <tr><th>Date</th><th>Customer Name</th><th>Remaining â‚¹</th><th>Bill No</th></tr>
  </thead>
  <tbody></tbody>
</table>

<hr>
<h3>ğŸ“‚ Upload Customer Name List</h3>
<input type="file" id="customerFile" accept=".txt,.csv">
<button onclick="uploadCustomerList()">ğŸ“¤ Upload</button>

<input type="file" id="itemFile" accept=".txt,.csv">
<button onclick="uploadItemList()">ğŸ“¤ Upload</button>
<hr>
<h3>ğŸ” Backup & Restore</h3>

<button onclick="exportBackup()">ğŸ“¤ Export Backup</button>
<input type="file" id="backupFile" accept=".json">
<button onclick="importBackup()">ğŸ“¥ Import Backup</button>

<h3>ğŸ“¦ Item-wise Summary Report</h3>
<input type="text" id="summaryItemName" placeholder="Enter Item Name">
<button onclick="showItemSummary()">ğŸ“Š Show Item Sale Summary</button>
<button onclick="clearItemSummary()">âŒ Clear Summary</button>
<div id="itemSummaryResult" style="margin-top: 10px; font-weight: bold;"></div>
<button onclick="exportBillsToExcel()">ğŸ“¥ Export to Excel</button>
</body>
</html>
